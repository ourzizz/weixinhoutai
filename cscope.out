cscope 16 C:\Qt\Qt5.7.1\5.7\mingw53_32\myproj\weixinhoutai               0000029727
	@employeeform.cpp

1 
	~<QtSql
>

2 
	~<QtWidg‘s
>

3 
	~"em¶oy“fÜm.h
"

4 
	~<QMes§geBox
>

6 
	gEm¶oy“FÜm
::
	$Em¶oy“FÜm
(
id
,
feid
,
QWidg‘
 *
·»Á
)

7 : 
	$QDŸlog
(
·»Á
)

9 
ÇmeEd™
 = 
Ãw
 
QLšeEd™
;

10 
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ¶ˆæ¯å†…å®¹:"));

11 
ÇmeLab–
->
	`£tBuddy
(
ÇmeEd™
);

13 
d•¬tm’tComboBox
 = 
Ãw
 
QComboBox
;

14 
d•¬tm’tLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ‰€å±æ–‡ä»¶"));

15 
d•¬tm’tLab–
->
	`£tBuddy
(
d•¬tm’tComboBox
);

17 
ex‹nsiÚLšeEd™
 = 
Ãw
 
QD©eEd™
;

18 
ex‹nsiÚLšeEd™
->
	`£tC®’d¬Pİup
(
Œue
);

19 
QD©e
 
today
 = QD©e::
	`cu¼’tD©e
();

20 
ex‹nsiÚLšeEd™
->
	`£tD©eRªge
(
today
.
	`addDays
(-290),oday.addDays(290));

21 
ex‹nsiÚLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("å‘å¸ƒæ—¶é—´"));

22 
ex‹nsiÚLab–
->
	`£tBuddy
(
ex‹nsiÚLšeEd™
);

24 
emaEd™
 = 
Ãw
 
QLšeEd™
;

25 
emaLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ‰€å±è€ƒè¯•"));

26 
emaLab–
->
	`£tBuddy
(
emaEd™
);

28 
¡¬tD©eEd™
 = 
Ãw
 
QD©eEd™
;

29 
¡¬tD©eEd™
->
	`£tC®’d¬Pİup
(
Œue
);

31 
¡¬tD©eEd™
->
	`£tD©eRªge
(
today
.
	`addDays
(-90),oday.addDays(90));

32 
¡¬tD©eLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("&å¤±æ•ˆæ—¶é—´:"));

33 
¡¬tD©eLab–
->
	`£tBuddy
(
¡¬tD©eEd™
);

34 
addBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Add"));

35 
d–‘eBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Delete"));

36 
şo£Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Close"));

38 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

39 
bu‰ÚBox
->
	`addBu‰Ú
(
addBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

40 
bu‰ÚBox
->
	`addBu‰Ú
(
d–‘eBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

41 
bu‰ÚBox
->
	`addBu‰Ú
(
şo£Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

43 
bËMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

44 
bËMod–
->
	`£tTabË
("ksmsg");

45 
bËMod–
->
	`£tR–©iÚ
(
Msg_Feid
,

46 
	`QSqlR–©iÚ
("ksfile", "ksfileid", "wjmc"));

47 
bËMod–
->
	`£tF‹r
(
	`QSŒšg
("ksmsg.ksfeid = %1").
	`¬g
(
feid
));

48 
bËMod–
->
	`£tSÜt
(
Msg_D—dtime
, 
Qt
::
AsûndšgOrd”
);

49 
bËMod–
->
	`£Ëù
();

51 
QSqlTabËMod–
 *
»ÏtiÚMod–
 =

52 
bËMod–
->
	`»ÏtiÚMod–
(
Msg_Feid
);

53 if(-1 !ğ
id
)

54 
»ÏtiÚMod–
->
	`£tF‹r
(
	`QSŒšg
("ksfeid=%1").
	`¬g
(
feid
));

55 
d•¬tm’tComboBox
->
	`£tMod–
(
»ÏtiÚMod–
);

56 
d•¬tm’tComboBox
->
	`£tMod–CŞumn
(

57 
»ÏtiÚMod–
->
	`f›ldIndex
("wjmc"));

59 
m­³r
 = 
Ãw
 
	`QD©aWidg‘M­³r
(
this
);

60 
m­³r
->
	`£tSubm™PŞicy
(
QD©aWidg‘M­³r
::
AutoSubm™
);

61 
m­³r
->
	`£tMod–
(
bËMod–
);

62 
m­³r
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

63 
m­³r
->
	`addM­pšg
(
ÇmeEd™
, 
Msg_MsgcÚ‹Á
);

64 
m­³r
->
	`addM­pšg
(
d•¬tm’tComboBox
, 
Msg_Feid
);

65 
m­³r
->
	`addM­pšg
(
ex‹nsiÚLšeEd™
, 
Msg_msgpubtime
);

66 
m­³r
->
	`addM­pšg
(
emaEd™
, 
Msg_Ksid
);

67 
m­³r
->
	`addM­pšg
(
¡¬tD©eEd™
, 
Msg_D—dtime
);

69 ià(
id
 != -1) {

70 
row
 = 0;„ow < 
bËMod–
->
	`rowCouÁ
(); ++row) {

71 
QSqlRecÜd
 
»cÜd
 = 
bËMod–
->
	`»cÜd
(
row
);

72 ià(
»cÜd
.
	`v®ue
(
Msg_Id
).
	`toIÁ
(è=ğ
id
) {

73 
m­³r
->
	`£tCu¼’tIndex
(
row
);

78 
bËMod–
->
	`š£¹Row
(0);

79 
m­³r
->
	`£tCu¼’tIndex
(0);

83 
	`cÚÃù
(
addBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`addEm¶oy“
()));

84 
	`cÚÃù
(
d–‘eBu‰Ú
, 
	`SIGNAL
(
	`şicked
()),

85 
this
, 
	`SLOT
(
	`d–‘eEm¶oy“
()));

86 
	`cÚÃù
(
şo£Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`acû±
()));

89 
QGridLayout
 *
mašLayout
 = 
Ãw
 QGridLayout;

90 
mašLayout
->
	`addWidg‘
(
ÇmeLab–
, 1, 0);

91 
mašLayout
->
	`addWidg‘
(
ÇmeEd™
, 1, 1, 1, 2);

92 
mašLayout
->
	`addWidg‘
(
d•¬tm’tLab–
, 2, 0);

93 
mašLayout
->
	`addWidg‘
(
d•¬tm’tComboBox
, 2, 1, 1, 2);

94 
mašLayout
->
	`addWidg‘
(
ex‹nsiÚLab–
, 3, 0);

95 
mašLayout
->
	`addWidg‘
(
ex‹nsiÚLšeEd™
, 3, 1);

96 
mašLayout
->
	`addWidg‘
(
emaLab–
, 4, 0);

97 
mašLayout
->
	`addWidg‘
(
emaEd™
, 4, 1, 1, 2);

98 
mašLayout
->
	`addWidg‘
(
¡¬tD©eLab–
, 5, 0);

99 
mašLayout
->
	`addWidg‘
(
¡¬tD©eEd™
, 5, 1);

100 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
, 7, 0, 1, 3);

101 
mašLayout
->
	`£tRowMšimumHeight
(6, 10);

102 
mašLayout
->
	`£tRowSŒ‘ch
(6, 1);

103 
mašLayout
->
	`£tCŞumnSŒ‘ch
(2, 1);

104 
	`£tLayout
(
mašLayout
);

106 
ÇmeEd™
->
	`£tFocus
();

107 
	`£tWšdowT™Ë
(
	`Œ
("æ¶ˆæ¯ç®¡ç†"));

108 
	}
}

110 
	gEm¶oy“FÜm
::
	$dÚe
(
»suÉ
)

112 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

113 
m­³r
->
	`subm™
();

114 
QDŸlog
::
	`dÚe
(
»suÉ
);

115 
	}
}

117 
	gEm¶oy“FÜm
::
	$addEm¶oy“
()

119 
row
 = 
m­³r
->
	`cu¼’tIndex
();

120 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

121 
m­³r
->
	`subm™
();

122 
bËMod–
->
	`š£¹Row
(
row
);

123 
m­³r
->
	`£tCu¼’tIndex
(
row
);

125 
ÇmeEd™
->
	`ş—r
();

126 
ex‹nsiÚLšeEd™
->
	`ş—r
();

127 
¡¬tD©eEd™
->
	`£tD©e
(
QD©e
::
	`cu¼’tD©e
());

128 
ÇmeEd™
->
	`£tFocus
();

129 
	}
}

131 
	gEm¶oy“FÜm
::
	$d–‘eEm¶oy“
()

133 
row
 = 
m­³r
->
	`cu¼’tIndex
();

134 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

135 
bËMod–
->
	`»moveRow
(
row
);

136 
m­³r
->
	`subm™
();

137 
m­³r
->
	`£tCu¼’tIndex
(
	`qMš
(
row
, 
bËMod–
->
	`rowCouÁ
() - 1));

138 
	}
}

	@employeeform.h

1 #iâdeà
EMPLOYEEFORM_H


2 
	#EMPLOYEEFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

6 
şass
 
	gQComboBox
;

7 
şass
 
	gQD©aWidg‘M­³r
;

8 
şass
 
	gQD©eEd™
;

9 
şass
 
	gQDŸlogBu‰ÚBox
;

10 
şass
 
	gQLab–
;

11 
şass
 
	gQLšeEd™
;

12 
şass
 
	gQPushBu‰Ú
;

13 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

16 
	mMsg_Id
 = 0,

17 
	mMsg_MsgcÚ‹Á
 = 1,

18 
	mMsg_msgpubtime
 = 2,

19 
	mMsg_Feid
 = 3,

20 
	mMsg_Ksid
 = 4,

21 
	mMsg_D—dtime
 = 5

24 şas 
	cEm¶oy“FÜm
 : 
public
 
QDŸlog


26 
Q_OBJECT


28 
public
:

29 
Em¶oy“FÜm
(
id
,
feid
, 
QWidg‘
 *
·»Á
 = 0);

31 
dÚe
(
»suÉ
);

33 
´iv©e
 
	m¦Ùs
:

34 
addEm¶oy“
();

35 
d–‘eEm¶oy“
();

37 
	m´iv©e
:

38 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

39 
QD©aWidg‘M­³r
 *
	mm­³r
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	md•¬tm’tLab–
;

42 
QLab–
 *
	mex‹nsiÚLab–
;

43 
QLab–
 *
	memaLab–
;

44 
QLab–
 *
	m¡¬tD©eLab–
;

45 
QLšeEd™
 *
	mÇmeEd™
;

46 
QComboBox
 *
	md•¬tm’tComboBox
;

47 
QD©eEd™
 *
	mex‹nsiÚLšeEd™
;

48 
QLšeEd™
 *
	memaEd™
;

49 
QD©eEd™
 *
	m¡¬tD©eEd™
;

50 
QPushBu‰Ú
 *
	mfœ¡Bu‰Ú
;

51 
QPushBu‰Ú
 *
	m´eviousBu‰Ú
;

52 
QPushBu‰Ú
 *
	mÃxtBu‰Ú
;

53 
QPushBu‰Ú
 *
	mÏ¡Bu‰Ú
;

54 
QPushBu‰Ú
 *
	maddBu‰Ú
;

55 
QPushBu‰Ú
 *
	md–‘eBu‰Ú
;

56 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

57 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@fileform.cpp

1 
	~<QtSql
>

2 
	~<QtWidg‘s
>

3 
	~"FeFÜm.h
"

4 
	~<QMes§geBox
>

6 
	gFeFÜm
::
	$FeFÜm
(
feid
,
QWidg‘
 *
·»Á
è: 
	$QDŸlog
(
·»Á
)

8 
ÇmeEd™
 = 
Ãw
 
QLšeEd™
;

9 
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ–‡ä»¶åç§°:"));

10 
ÇmeLab–
->
	`£tBuddy
(
ÇmeEd™
);

12 
kaoshiComboBox
 = 
Ãw
 
QComboBox
;

13 
kaoshiLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ‰€å±è€ƒè¯•"));

14 
kaoshiLab–
->
	`£tBuddy
(
kaoshiComboBox
);

16 
pubTimeEd™
 = 
Ãw
 
QD©eEd™
;

17 
pubTimeLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("å‘å¸ƒæ—¶é—´"));

18 
pubTimeLab–
->
	`£tBuddy
(
pubTimeEd™
);

20 
webAddEd™
ğ
Ãw
 
QLšeEd™
;

21 
webAddLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æºåœ°å€"));

22 
webAddLab–
->
	`£tBuddy
(
webAddEd™
);

24 
addBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("æ·»åŠ æ–‡ä»¶"));

25 
d–‘eBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("åˆ é™¤æ–‡ä»¶"));

26 
şo£Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("å…³é—­"));

27 
subm™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("æäº¤"));

29 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

30 
bu‰ÚBox
->
	`addBu‰Ú
(
addBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

31 
bu‰ÚBox
->
	`addBu‰Ú
(
d–‘eBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

32 
bu‰ÚBox
->
	`addBu‰Ú
(
subm™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

33 
bu‰ÚBox
->
	`addBu‰Ú
(
şo£Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

35 
bËMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

36 
bËMod–
->
	`£tTabË
("ksfile");

37 
bËMod–
->
	`£tR–©iÚ
(
Ksfe_Ksid
,

38 
	`QSqlR–©iÚ
("kstype", "ksid", "ksname"));

39 
bËMod–
->
	`£tF‹r
(
	`QSŒšg
("ksfe.ksfeid = %1 ").
	`¬g
(
feid
));

40 
bËMod–
->
	`£Ëù
();

43 
QSqlTabËMod–
 *
»ÏtiÚMod–
 =

44 
bËMod–
->
	`»ÏtiÚMod–
(
Ksfe_Ksid
);

47 
kaoshiComboBox
->
	`£tMod–
(
»ÏtiÚMod–
);

48 
kaoshiComboBox
->
	`£tMod–CŞumn
(

50 
»ÏtiÚMod–
->
	`f›ldIndex
("ksname"));

52 
m­³r
 = 
Ãw
 
	`QD©aWidg‘M­³r
(
this
);

53 
m­³r
->
	`£tSubm™PŞicy
(
QD©aWidg‘M­³r
::
Mªu®Subm™
);

54 
m­³r
->
	`£tMod–
(
bËMod–
);

55 
m­³r
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

56 
m­³r
->
	`addM­pšg
(
ÇmeEd™
, 
Ksfe_Wjmc
);

57 
m­³r
->
	`addM­pšg
(
kaoshiComboBox
, 
Ksfe_Ksid
);

58 
m­³r
->
	`addM­pšg
(
pubTimeEd™
, 
Ksfe_F•utime
);

59 
m­³r
->
	`addM­pšg
(
webAddEd™
, 
Ksfe_Webadd»ss
);

61 ià(
feid
 != -1) {

62 
row
 = 0;„ow < 
bËMod–
->
	`rowCouÁ
(); ++row) {

63 
QSqlRecÜd
 
»cÜd
 = 
bËMod–
->
	`»cÜd
(
row
);

64 ià(
»cÜd
.
	`v®ue
(
Ksfe_Ksfeid
).
	`toIÁ
(è=ğ
feid
) {

65 
m­³r
->
	`£tCu¼’tIndex
(
row
);

70 
m­³r
->
	`toFœ¡
();

71 
bËMod–
->
	`š£¹Row
(0);

72 
m­³r
->
	`£tCu¼’tIndex
(0);

75 
	`cÚÃù
(
addBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`addFe
()));

76 
	`cÚÃù
(
d–‘eBu‰Ú
, 
	`SIGNAL
(
	`şicked
()),

77 
this
, 
	`SLOT
(
	`d–‘eFe
()));

78 
	`cÚÃù
(
şo£Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
QDŸlog
::
	`dÚe
(0)));

79 
	`cÚÃù
(
subm™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`acû±
()));

82 
QGridLayout
 *
mašLayout
 = 
Ãw
 QGridLayout;

83 
mašLayout
->
	`addWidg‘
(
ÇmeLab–
, 1, 0);

84 
mašLayout
->
	`addWidg‘
(
ÇmeEd™
, 1, 1, 1, 2);

85 
mašLayout
->
	`addWidg‘
(
pubTimeLab–
, 2, 0);

86 
mašLayout
->
	`addWidg‘
(
pubTimeEd™
, 2, 1, 1, 2);

87 
mašLayout
->
	`addWidg‘
(
kaoshiLab–
, 3, 0);

88 
mašLayout
->
	`addWidg‘
(
kaoshiComboBox
, 3, 1, 1, 2);

89 
mašLayout
->
	`addWidg‘
(
webAddLab–
, 4, 0);

90 
mašLayout
->
	`addWidg‘
(
webAddEd™
, 4, 1,1,2);

92 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
, 7, 0, 1, 3);

93 
mašLayout
->
	`£tRowMšimumHeight
(6, 10);

94 
mašLayout
->
	`£tRowSŒ‘ch
(6, 1);

95 
mašLayout
->
	`£tCŞumnSŒ‘ch
(2, 1);

96 
	`£tLayout
(
mašLayout
);

98 
ÇmeEd™
->
	`£tFocus
();

99 
	`£tWšdowT™Ë
(
	`Œ
("æ–‡ä»¶ç®¡ç†"));

100 
	}
}

102 
	gFeFÜm
::
	$dÚe
(
»suÉ
)

104 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

105 
m­³r
->
	`subm™
();

106 
QDŸlog
::
	`dÚe
(
»suÉ
);

107 
	}
}

109 
	gFeFÜm
::
	$mªu®Subm™
()

111 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

112 
m­³r
->
	`subm™
();

113 
	}
}

115 
	gFeFÜm
::
	$addFe
()

117 
row
 = 
m­³r
->
	`cu¼’tIndex
();

118 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

119 
m­³r
->
	`subm™
();

120 
bËMod–
->
	`š£¹Row
(
row
);

121 
m­³r
->
	`£tCu¼’tIndex
(
row
);

123 
ÇmeEd™
->
	`ş—r
();

124 
pubTimeEd™
->
	`ş—r
();

125 
webAddEd™
->
	`ş—r
();

126 
ÇmeEd™
->
	`£tFocus
();

127 
	}
}

129 
	gFeFÜm
::
	$d–‘eFe
()

131 
row
 = 
m­³r
->
	`cu¼’tIndex
();

132 
bËMod–
->
	`»moveRow
(
row
);

133 if(!(
ÇmeEd™
->
	`‹xt
().
	`isEm±y
()))

134 
m­³r
->
	`subm™
();

135 
m­³r
->
	`£tCu¼’tIndex
(
	`qMš
(
row
, 
bËMod–
->
	`rowCouÁ
() - 1));

136 
	}
}

	@fileform.h

1 #iâdeà
FILEFORM_H


2 
	#FILEFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

6 
şass
 
	gQComboBox
;

7 
şass
 
	gQD©aWidg‘M­³r
;

8 
şass
 
	gQD©eEd™
;

9 
şass
 
	gQDŸlogBu‰ÚBox
;

10 
şass
 
	gQLab–
;

11 
şass
 
	gQLšeEd™
;

12 
şass
 
	gQPushBu‰Ú
;

13 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

16 
	mKsfe_Ksfeid
 = 0,

17 
	mKsfe_Ksid
 = 1,

18 
	mKsfe_Wjmc
 = 2,

19 
	mKsfe_F•utime
 = 3,

20 
	mKsfe_Webadd»ss
 = 4,

23 şas 
	cFeFÜm
 : 
public
 
QDŸlog


25 
Q_OBJECT


27 
public
:

28 
FeFÜm
(
msgid
, 
QWidg‘
 *
·»Á
 = 0);

30 
dÚe
(
»suÉ
);

31 
mªu®Subm™
();

33 
´iv©e
 
	m¦Ùs
:

34 
addFe
();

35 
d–‘eFe
();

37 
	m´iv©e
:

38 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

39 
QD©aWidg‘M­³r
 *
	mm­³r
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	mpubTimeLab–
;

42 
QLab–
 *
	mwebAddLab–
;

43 
QLab–
 *
	mkaoshiLab–
;

45 
QComboBox
 *
	mkaoshiComboBox
;

46 
QLšeEd™
 *
	mÇmeEd™
;

47 
QD©eEd™
 *
	mpubTimeEd™
;

48 
QLšeEd™
 *
	mwebAddEd™
;

50 
QPushBu‰Ú
 *
	maddBu‰Ú
;

51 
QPushBu‰Ú
 *
	md–‘eBu‰Ú
;

52 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

53 
QPushBu‰Ú
 *
	msubm™Bu‰Ú
;

54 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@kaoshiform.cpp

1 
	~<QtSql
>

2 
	~<QtWidg‘s
>

3 
	~"KaoshiFÜm.h
"

4 
	~<QMes§geBox
>

6 
	gKaoshiFÜm
::
	$KaoshiFÜm
(
QSŒšg
 
pšyš
,
QWidg‘
 *
·»Á
è: 
	$QDŸlog
(
·»Á
)

8 
ÇmeEd™
 = 
Ãw
 
QLšeEd™
;

9 
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("è€ƒè¯•åç§°:"));

10 
ÇmeLab–
->
	`£tBuddy
(
ÇmeEd™
);

12 
pšyšEd™
 = 
Ãw
 
QLšeEd™
;

13 
pšyšLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("é¦–æ‹¼ä¸»é”®ä¸èƒ½é‡å¤"));

14 
pšyšLab–
->
	`£tBuddy
(
pšyšEd™
);

16 
hÙEd™
ğ
Ãw
 
QLšeEd™
;

17 
hÙLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("æ‰‹åŠ¨çƒ­åº¦è°ƒæ•´"));

18 
hÙLab–
->
	`£tBuddy
(
hÙEd™
);

20 
addBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("æ·»åŠ è€ƒè¯•"));

22 
şo£Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("å…³é—­"));

23 
subm™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("æäº¤"));

25 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

26 
bu‰ÚBox
->
	`addBu‰Ú
(
addBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

27 
bu‰ÚBox
->
	`addBu‰Ú
(
subm™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

28 
bu‰ÚBox
->
	`addBu‰Ú
(
şo£Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

30 
bËMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

31 
bËMod–
->
	`£tTabË
("kstype");

32 
bËMod–
->
	`£Ëù
();

34 
m­³r
 = 
Ãw
 
	`QD©aWidg‘M­³r
(
this
);

35 
m­³r
->
	`£tSubm™PŞicy
(
QD©aWidg‘M­³r
::
Mªu®Subm™
);

36 
m­³r
->
	`£tMod–
(
bËMod–
);

37 
m­³r
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

38 
m­³r
->
	`addM­pšg
(
pšyšEd™
, 
K¡y³_Pšyš
);

39 
m­³r
->
	`addM­pšg
(
ÇmeEd™
, 
K¡y³_Name
);

40 
m­³r
->
	`addM­pšg
(
hÙEd™
, 
K¡y³_HÙ
);

42 ià(
pšyš
 != "" ) {

43 
row
 = 0;„ow < 
bËMod–
->
	`rowCouÁ
(); ++row) {

44 
QSqlRecÜd
 
»cÜd
 = 
bËMod–
->
	`»cÜd
(
row
);

45 ià(
»cÜd
.
	`v®ue
(
K¡y³_Pšyš
è=ğ
pšyš
) {

46 
m­³r
->
	`£tCu¼’tIndex
(
row
);

51 
m­³r
->
	`toFœ¡
();

52 
bËMod–
->
	`š£¹Row
(0);

53 
m­³r
->
	`£tCu¼’tIndex
(0);

56 
	`cÚÃù
(
addBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`addFe
()));

59 
	`cÚÃù
(
şo£Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
QDŸlog
::
	`dÚe
(0)));

60 
	`cÚÃù
(
subm™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`acû±
()));

63 
QGridLayout
 *
mašLayout
 = 
Ãw
 QGridLayout;

64 
mašLayout
->
	`addWidg‘
(
ÇmeLab–
, 1, 0);

65 
mašLayout
->
	`addWidg‘
(
ÇmeEd™
, 1, 1, 1, 2);

66 
mašLayout
->
	`addWidg‘
(
pšyšLab–
, 2, 0);

67 
mašLayout
->
	`addWidg‘
(
pšyšEd™
, 2, 1, 1, 2);

70 
mašLayout
->
	`addWidg‘
(
hÙLab–
, 4, 0);

71 
mašLayout
->
	`addWidg‘
(
hÙEd™
, 4, 1,1,2);

73 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
, 7, 0, 1, 3);

74 
mašLayout
->
	`£tRowMšimumHeight
(6, 10);

75 
mašLayout
->
	`£tRowSŒ‘ch
(6, 1);

76 
mašLayout
->
	`£tCŞumnSŒ‘ch
(2, 1);

77 
	`£tLayout
(
mašLayout
);

79 
ÇmeEd™
->
	`£tFocus
();

80 
	`£tWšdowT™Ë
(
	`Œ
("æ–‡ä»¶ç®¡ç†"));

81 
	}
}

83 
	gKaoshiFÜm
::
	$dÚe
(
»suÉ
)

85 
m­³r
->
	`subm™
();

86 
QDŸlog
::
	`dÚe
(
»suÉ
);

87 
	}
}

89 
	gKaoshiFÜm
::
	$mªu®Subm™
()

91 
m­³r
->
	`subm™
();

92 
	}
}

94 
	gKaoshiFÜm
::
	$addFe
()

96 
row
 = 
m­³r
->
	`cu¼’tIndex
();

97 
m­³r
->
	`subm™
();

98 
bËMod–
->
	`š£¹Row
(
row
);

99 
m­³r
->
	`£tCu¼’tIndex
(
row
);

101 
ÇmeEd™
->
	`ş—r
();

102 
pšyšEd™
->
	`ş—r
();

103 
hÙEd™
->
	`ş—r
();

104 
ÇmeEd™
->
	`£tFocus
();

105 
	}
}

107 
	gKaoshiFÜm
::
	$d–‘eFe
()

109 
row
 = 
m­³r
->
	`cu¼’tIndex
();

110 
bËMod–
->
	`»moveRow
(
row
);

111 
m­³r
->
	`subm™
();

112 
m­³r
->
	`£tCu¼’tIndex
(
	`qMš
(
row
, 
bËMod–
->
	`rowCouÁ
() - 1));

113 
	}
}

	@kaoshiform.h

1 #iâdeà
KAOSHIFORM_H


2 
	#KAOSHIFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

5 
	~<QSŒšg
>

7 
şass
 
	gQComboBox
;

8 
şass
 
	gQD©aWidg‘M­³r
;

9 
şass
 
	gQD©eEd™
;

10 
şass
 
	gQDŸlogBu‰ÚBox
;

11 
şass
 
	gQLab–
;

12 
şass
 
	gQLšeEd™
;

13 
şass
 
	gQPushBu‰Ú
;

14 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

17 
	mK¡y³_Pšyš
 = 0,

18 
	mK¡y³_Name
 = 1,

19 
	mK¡y³_HÙ
 = 2,

22 şas 
	cKaoshiFÜm
 : 
public
 
QDŸlog


24 
Q_OBJECT


26 
public
:

27 
KaoshiFÜm
(
QSŒšg
 
ksid
, 
QWidg‘
 *
·»Á
 = 0);

29 
dÚe
(
»suÉ
);

30 
mªu®Subm™
();

32 
´iv©e
 
	m¦Ùs
:

33 
addFe
();

34 
d–‘eFe
();

36 
	m´iv©e
:

37 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

38 
QD©aWidg‘M­³r
 *
	mm­³r
;

39 
QLab–
 *
	mpšyšLab–
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	mhÙLab–
;

45 
QLšeEd™
 *
	mpšyšEd™
;

46 
QLšeEd™
 *
	mÇmeEd™
;

47 
QLšeEd™
 *
	mhÙEd™
;

49 
QPushBu‰Ú
 *
	maddBu‰Ú
;

50 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

51 
QPushBu‰Ú
 *
	msubm™Bu‰Ú
;

52 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@main.cpp

1 
	~<QtGui
>

2 
	~<QtSql
>

3 
	~<c¡dlib
>

4 
	~<QtWidg‘s
>

6 
	~"mašfÜm.h
"

8 
boŞ
 
	$ü—‹CÚÃùiÚ
()

10 
QSqlD©aba£
 
db
 = QSqlD©aba£::
	`addD©aba£
("QMYSQL");

12 
db
.
	`£tHo¡Name
("58.87.119.233");

14 
db
.
	`£tD©aba£Name
("bjks2");

15 
db
.
	`£tU£rName
("root");

16 
db
.
	`£tPasswÜd
("123123");

17 ià(!
db
.
	`İ’
()) {

18 
QMes§geBox
::
	`w¬nšg
(0, 
QObjeù
::
	`Œ
("Database Error"),

19 
db
.
	`Ï¡E¼Ü
().
	`‹xt
());

20  
çl£
;

22  
Œue
;

23 
	}
}

25 
	$maš
(
¬gc
, *
¬gv
[])

27 
QAµliÿtiÚ
 
	`­p
(
¬gc
, 
¬gv
);

28 
	`ü—‹CÚÃùiÚ
();

29 
MašFÜm
 
fÜm
;

30 
fÜm
.
	`»size
(500, 600);

31 
fÜm
.
	`show
();

32  
­p
.
	`exec
();

33 
	}
}

	@mainform.cpp

1 
	~<QtGui
>

2 
	~<QtSql
>

3 
	~<SŒšg
>

4 
	~"em¶oy“fÜm.h
"

5 
	~"fefÜm.h
"

6 
	~"kaoshifÜm.h
"

7 
	~"mašfÜm.h
"

9 
	gMašFÜm
::
	$MašFÜm
()

11 
	`ü—‹FePª–
();

12 
	`ü—‹MsgPª–
();

13 
	`ü—‹KaoshiPª–
();

15 
ed™KaoshiBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&ç¼–è¾‘è€ƒè¯•."));

17 
ed™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("ç¼–è¾‘æ¶ˆæ¯"));

18 
ed™FeBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("ç¼–è¾‘æ–‡ä»¶"));

19 
qu™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Quit"));

21 
ed™febu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

22 
ed™febu‰ÚBox
->
	`addBu‰Ú
(
ed™FeBu‰Ú
,
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

24 
ed™kaoshibu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

25 
ed™kaoshibu‰ÚBox
->
	`addBu‰Ú
(
ed™KaoshiBu‰Ú
,
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

27 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

28 
bu‰ÚBox
->
	`addBu‰Ú
(
ed™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

29 
bu‰ÚBox
->
	`addBu‰Ú
(
qu™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

31 
¥l™‹r
 = 
Ãw
 
	`QS¶™‹r
(
Qt
::
V”tiÿl
);

32 
¥l™‹r
->
	`£tF¿meStyË
(
QF¿me
::
StyËdPª–
);

33 
¥l™‹r
->
	`addWidg‘
(
fePª–
);

34 
¥l™‹r
->
	`addWidg‘
(
ed™febu‰ÚBox
);

35 
¥l™‹r
->
	`addWidg‘
(
msgPª–
);

38 
	`cÚÃù
(
ed™KaoshiBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`ed™kaoshi
()));

39 
	`cÚÃù
(
ed™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`ed™msgs
()));

40 
	`cÚÃù
(
ed™FeBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`ed™fe
()));

41 
	`cÚÃù
(
qu™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`şo£
()));

43 
QVBoxLayout
 *
mašLayout
 = 
Ãw
 QVBoxLayout;

44 
mašLayout
->
	`addWidg‘
(
kaoshiPª–
);

45 
mašLayout
->
	`addWidg‘
(
ed™kaoshibu‰ÚBox
);

46 
bu‰ÚBox
->
	`addBu‰Ú
(
qu™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

47 
mašLayout
->
	`addWidg‘
(
¥l™‹r
);

48 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
);

50 
	`£tLayout
(
mašLayout
);

52 
	`£tWšdowT™Ë
(
	`Œ
("åå°ç®¡ç†"));

53 
feV›w
->
	`£tCu¼’tIndex
(
feMod–
->
	`šdex
(0, 0));

54 
	}
}

56 
	gMašFÜm
::
	$upd©eMsgV›w
()

58 
QMod–Index
 
šdex
 = 
feV›w
->
	`cu¼’tIndex
();

59 ià(
šdex
.
	`isV®id
()) {

60 
QSqlRecÜd
 
»cÜd
 = 
feMod–
->
	`»cÜd
(
šdex
.
	`row
());

61 
id
 = 
»cÜd
.
	`v®ue
("ksfeid").
	`toIÁ
();

62 
msgMod–
->
	`£tF‹r
(
	`QSŒšg
("ksmsg.ksfeid = %1").
	`¬g
(
id
));

63 
msgLab–
->
	`£tText
(
	`Œ
("é…ç½® %1 è€ƒè¯•çš„æ¶ˆæ¯msg")

64 .
	`¬g
(
»cÜd
.
	`v®ue
("ksid").
	`toSŒšg
()));

67 
msgMod–
->
	`£tF‹r
("ksfileid = -1");

68 
msgLab–
->
	`£tText
(
	`Œ
("E&mployees"));

70 
msgMod–
->
	`£Ëù
();

71 
msgV›w
->
	`hÜizÚlH—d”
()->
	`£tVisibË
(

72 
msgMod–
->
	`rowCouÁ
() > 0);

75 
	}
}

77 
	gMašFÜm
::
	$addfe
()

79 
row
 = 
feMod–
->
	`rowCouÁ
();

80 
feMod–
->
	`š£¹Row
(
row
);

81 
QMod–Index
 
šdex
 = 
feMod–
->
	`šdex
(
row
, 
Ksfe_ksid
);

82 
feV›w
->
	`£tCu¼’tIndex
(
šdex
);

83 
feV›w
->
	`ed™
(
šdex
);

84 
	}
}

86 
	gMašFÜm
::
	$d–‘efe
()

88 
QMod–Index
 
šdex
 = 
feV›w
->
	`cu¼’tIndex
();

89 ià(!
šdex
.
	`isV®id
())

92 
QSqlD©aba£
::
	`d©aba£
().
	`Œª§ùiÚ
();

93 
QSqlRecÜd
 
»cÜd
 = 
feMod–
->
	`»cÜd
(
šdex
.
	`row
());

94 
id
 = 
»cÜd
.
	`v®ue
(
Ksfe_ksfeid
).
	`toIÁ
();

95 
nummsgs
 = 0;

97 
QSqlQu”y
 
	`qu”y
(
	`QSŒšg
("SELECT COUNT(*) FROM msg "

98 "WHERE feid = %1").
	`¬g
(
id
));

99 ià(
qu”y
.
	`Ãxt
())

100 
nummsgs
 = 
qu”y
.
	`v®ue
(0).
	`toIÁ
();

101 ià(
nummsgs
 > 0) {

102 
r
 = 
QMes§geBox
::
	`w¬nšg
(
this
, 
	`Œ
("Delete file"),

103 
	`Œ
("Delete %1‡nd‡ll its msgs?")

104 .
	`¬g
(
»cÜd
.
	`v®ue
(
Ksfe_ksid
).
	`toSŒšg
()),

105 
QMes§geBox
::
Yes
 | QMes§geBox::
No
);

106 ià(
r
 =ğ
QMes§geBox
::
No
) {

107 
QSqlD©aba£
::
	`d©aba£
().
	`rŞlback
();

111 
qu”y
.
	`exec
(
	`QSŒšg
("DELETE FROM msg "

112 "WHERE feid = %1").
	`¬g
(
id
));

115 
feMod–
->
	`»moveRow
(
šdex
.
	`row
());

116 
feMod–
->
	`subm™AÎ
();

117 
QSqlD©aba£
::
	`d©aba£
().
	`comm™
();

119 
	`upd©eMsgV›w
();

120 
feV›w
->
	`£tFocus
();

121 
	}
}

123 
	gMašFÜm
::
	$ed™msgs
()

125 
msgId
 = -1;

126 
ksfeid
 = -1;

127 
QMod–Index
 
šdex
 = 
msgV›w
->
	`cu¼’tIndex
();

128 ià(
šdex
.
	`isV®id
()) {

129 
QSqlRecÜd
 
»cÜd
 = 
msgMod–
->
	`»cÜd
(
šdex
.
	`row
());

130 
msgId
 = 
»cÜd
.
	`v®ue
(
Msg_Id
).
	`toIÁ
();

131 
ksfeid
 = 
»cÜd
.
	`v®ue
(
Msg_Feid
).
	`toIÁ
();

134 
Em¶oy“FÜm
 
	`fÜm
(
msgId
,
ksfeid
,
this
);

135 
fÜm
.
	`exec
();

136 
	`upd©eMsgV›w
();

137 
	}
}

139 
	gMašFÜm
::
	$ed™fe
()

141 
ksfeid
 = -1;

142 
QMod–Index
 
šdex
 = 
feV›w
->
	`cu¼’tIndex
();

143 ià(
šdex
.
	`isV®id
()) {

144 
QSqlRecÜd
 
»cÜd
 = 
feMod–
->
	`»cÜd
(
šdex
.
	`row
());

145 
ksfeid
 = 
»cÜd
.
	`v®ue
(
Ksfe_ksfeid
).
	`toIÁ
();

147 
FeFÜm
 
	`fÜm
(
ksfeid
,
this
);

148 
fÜm
.
	`exec
();

149 
	`upd©eFeV›w
();

150 
	}
}

152 
	gMašFÜm
::
	$ed™kaoshi
()

154 
QSŒšg
 
ksid
 = "";

155 
QMod–Index
 
šdex
 = 
kaoshiV›w
->
	`cu¼’tIndex
();

156 ià(
šdex
.
	`isV®id
()) {

157 
QSqlRecÜd
 
»cÜd
 = 
kaoshiMod–
->
	`»cÜd
(
šdex
.
	`row
());

158 
ksid
 = 
»cÜd
.
	`v®ue
(
K¡y³_Pšyš
).
	`toSŒšg
();

160 
KaoshiFÜm
 
	`fÜm
(
ksid
,
this
);

161 
fÜm
.
	`exec
();

162 
	`upd©eKaoshiV›w
();

163 
	}
}

165 
	gMašFÜm
::
	$ü—‹FePª–
()

167 
fePª–
 = 
Ãw
 
QWidg‘
;

168 
feMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

169 
feMod–
->
	`£tTabË
("ksfile");

170 
feMod–
->
	`£tSÜt
(
Ksfe_ksid
, 
Qt
::
AsûndšgOrd”
);

171 
feMod–
->
	`£Ëù
();

173 
feV›w
 = 
Ãw
 
QTabËV›w
;

174 
feV›w
->
	`£tMod–
(
feMod–
);

175 
feV›w
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

176 
feV›w
->
	`£tS–eùiÚMode
(

177 
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

178 
feV›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

180 
feV›w
->
	`»sizeCŞumnsToCÚ‹Ás
();

181 
feV›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

182 
feV›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

183 
feV›w
->
	`£tCŞumnHidd’
(0, 
Œue
);

184 
feV›w
->
	`£tCŞumnHidd’
(1, 
Œue
);

186 
feLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("Depar&tments"));

187 
feLab–
->
	`£tBuddy
(
feV›w
);

189 
	`cÚÃù
(
feV›w
->
	`£ËùiÚMod–
(),

190 
	`SIGNAL
(
	`cu¼’tRowChªged
(cÚ¡ 
QMod–Index
 &,

191 cÚ¡ 
QMod–Index
 &)),

192 
this
, 
	`SLOT
(
	`upd©eMsgV›w
()));

194 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

195 
Ïyout
->
	`addWidg‘
(
feLab–
);

196 
Ïyout
->
	`addWidg‘
(
feV›w
);

197 
fePª–
->
	`£tLayout
(
Ïyout
);

198 
	}
}

200 
	gMašFÜm
::
	$ü—‹MsgPª–
()

202 
msgPª–
 = 
Ãw
 
QWidg‘
;

203 
msgMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

204 
msgMod–
->
	`£tTabË
("ksmsg");

205 
msgMod–
->
	`£tR–©iÚ
(3,

206 
	`QSqlR–©iÚ
("ksfile","ksfileid","ksfileid"));

207 
msgMod–
->
	`£tSÜt
(
Msg_Id
, 
Qt
::
AsûndšgOrd”
);

208 
msgMod–
->
	`£tH—d”D©a
(1, 
Qt
::
HÜizÚl
,

209 
	`Œ
("æ¶ˆæ¯å†…å®¹"));

210 
msgMod–
->
	`£tH—d”D©a
(2, 
Qt
::
HÜizÚl
,

211 
	`Œ
("å‘å¸ƒæ—¶é—´"));

212 
msgMod–
->
	`£tH—d”D©a
(5, 
Qt
::
HÜizÚl
,

213 
	`Œ
("å¤±æ•ˆæ—¶é—´"));

215 
msgV›w
 = 
Ãw
 
QTabËV›w
;

216 
msgV›w
->
	`£tMod–
(
msgMod–
);

217 
msgV›w
->
	`£tS–eùiÚMode
(
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

218 
msgV›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

219 
msgV›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

220 
msgV›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

221 
msgV›w
->
	`£tCŞumnHidd’
(0, 
Œue
);

222 
msgV›w
->
	`£tCŞumnHidd’
(3, 
Œue
);

223 
msgV›w
->
	`£tCŞumnHidd’
(4, 
Œue
);

225 
msgLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("E&mployees"));

226 
msgLab–
->
	`£tBuddy
(
msgV›w
);

228 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

229 
Ïyout
->
	`addWidg‘
(
msgLab–
);

230 
Ïyout
->
	`addWidg‘
(
msgV›w
);

231 
msgPª–
->
	`£tLayout
(
Ïyout
);

232 
	}
}

234 
	gMašFÜm
::
	$ü—‹KaoshiPª–
()

236 
kaoshiPª–
 = 
Ãw
 
QWidg‘
;

237 
kaoshiMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

238 
kaoshiMod–
->
	`£tTabË
("kstype");

239 
kaoshiMod–
->
	`£Ëù
();

240 
kaoshiV›w
 = 
Ãw
 
QTabËV›w
;

241 
kaoshiV›w
->
	`£tMod–
(
kaoshiMod–
);

242 
kaoshiV›w
->
	`£tS–eùiÚMode
(
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

243 
kaoshiV›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

244 
kaoshiV›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

245 
kaoshiV›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

247 
kaoshiLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("è€ƒè¯•ç‰ˆé¢"));

248 
kaoshiLab–
->
	`£tBuddy
(
kaoshiV›w
);

250 
	`cÚÃù
(
kaoshiV›w
->
	`£ËùiÚMod–
(),

251 
	`SIGNAL
(
	`cu¼’tRowChªged
(cÚ¡ 
QMod–Index
 &,

252 cÚ¡ 
QMod–Index
 &)),

253 
this
, 
	`SLOT
(
	`upd©eFeV›w
()));

254 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

255 
Ïyout
->
	`addWidg‘
(
kaoshiLab–
);

256 
Ïyout
->
	`addWidg‘
(
kaoshiV›w
);

257 
kaoshiPª–
->
	`£tLayout
(
Ïyout
);

258 
	}
}

260 
	gMašFÜm
::
	$upd©eFeV›w
()

262 
QMod–Index
 
šdex
 = 
kaoshiV›w
->
	`cu¼’tIndex
();

263 ià(
šdex
.
	`isV®id
()) {

264 
QSqlRecÜd
 
»cÜd
 = 
kaoshiMod–
->
	`»cÜd
(
šdex
.
	`row
());

265 
QSŒšg
 
id
 = 
»cÜd
.
	`v®ue
("ksid").
	`toSŒšg
();

266 
feMod–
->
	`£tF‹r
(
	`QSŒšg
("ksfe.ksid = \"%1\" ").
	`¬g
(
id
));

268 
feLab–
->
	`£tText
(
	`Œ
(" %1 æ–‡ä»¶ç®¡ç†")

269 .
	`¬g
(
»cÜd
.
	`v®ue
("k¢ame").
	`toSŒšg
()));

272 
feMod–
->
	`£tF‹r
("ksid = -1");

273 
feLab–
->
	`£tText
(
	`Œ
("è€ƒè¯•æ–‡ä»¶"));

275 
feMod–
->
	`£Ëù
();

276 
feV›w
->
	`hÜizÚlH—d”
()->
	`£tVisibË
(

277 
feMod–
->
	`rowCouÁ
() > 0);

278 
	}
}

280 
	gMašFÜm
::
	$upd©eKaoshiV›w
()

294 
kaoshiMod–
->
	`£Ëù
();

295 
kaoshiV›w
->
	`hÜizÚlH—d”
()->
	`£tVisibË
(

296 
feMod–
->
	`rowCouÁ
() > 0);

297 
	}
}

	@mainform.h

1 #iâdeà
MAINFORM_H


2 
	#MAINFORM_H


	)

4 
	~<QWidg‘
>

6 
şass
 
	gQDŸlogBu‰ÚBox
;

7 
şass
 
	gQLab–
;

8 
şass
 
	gQMod–Index
;

9 
şass
 
	gQPushBu‰Ú
;

10 
şass
 
	gQS¶™‹r
;

11 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

12 
şass
 
	gQTabËV›w
;

15 
	mKsfe_ksfeid
 = 0,

16 
	mKsfe_ksid
 = 1,

17 
	mKsfe_wjmc
 = 2,

18 
	mksfe_f•ubtime
 = 3,

19 
	mKsfe_webadd»ss
 = 4,

22 şas 
	cMašFÜm
 : 
public
 
QWidg‘


24 
Q_OBJECT


26 
public
:

27 
MašFÜm
();

29 
´iv©e
 
	m¦Ùs
:

30 
upd©eMsgV›w
();

31 
upd©eKaoshiV›w
();

32 
upd©eFeV›w
();

33 
addfe
();

34 
d–‘efe
();

35 
ed™msgs
();

36 
ed™fe
();

37 
ed™kaoshi
();

39 
	m´iv©e
:

40 
ü—‹FePª–
();

41 
ü—‹MsgPª–
();

42 
ü—‹KaoshiPª–
();

44 
QSqlR–©iÚ®TabËMod–
 *
	mfeMod–
;

45 
QSqlR–©iÚ®TabËMod–
 *
	mmsgMod–
;

46 
QSqlR–©iÚ®TabËMod–
 *
	mkaoshiMod–
;

48 
QWidg‘
 *
	mfePª–
;

49 
QWidg‘
 *
	mmsgPª–
;

50 
QWidg‘
 *
	mkaoshiPª–
;

51 
QLab–
 *
	mfeLab–
;

52 
QLab–
 *
	mmsgLab–
;

53 
QLab–
 *
	mkaoshiLab–
;

55 
QTabËV›w
 *
	mfeV›w
;

56 
QTabËV›w
 *
	mmsgV›w
;

57 
QTabËV›w
 *
	mkaoshiV›w
;

59 
QS¶™‹r
 *
	m¥l™‹r
;

60 
QS¶™‹r
 *
	mkaoshi¥l™‹r
;

62 
QPushBu‰Ú
 *
	med™KaoshiBu‰Ú
;

64 
QPushBu‰Ú
 *
	med™Bu‰Ú
;

65 
QPushBu‰Ú
 *
	med™FeBu‰Ú
;

66 
QPushBu‰Ú
 *
	mqu™Bu‰Ú
;

67 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

68 
QDŸlogBu‰ÚBox
 *
	med™febu‰ÚBox
;

69 
QDŸlogBu‰ÚBox
 *
	med™kaoshibu‰ÚBox
;

	@FileForm.h

1 #iâdeà
FILEFORM_H


2 
	#FILEFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

6 
şass
 
	gQComboBox
;

7 
şass
 
	gQD©aWidg‘M­³r
;

8 
şass
 
	gQD©eEd™
;

9 
şass
 
	gQDŸlogBu‰ÚBox
;

10 
şass
 
	gQLab–
;

11 
şass
 
	gQLšeEd™
;

12 
şass
 
	gQPushBu‰Ú
;

13 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

16 
	mKsfe_Ksfeid
 = 0,

17 
	mKsfe_Ksid
 = 1,

18 
	mKsfe_Wjmc
 = 2,

19 
	mKsfe_F•utime
 = 3,

20 
	mKsfe_Webadd»ss
 = 4,

23 şas 
	cFeFÜm
 : 
public
 
QDŸlog


25 
Q_OBJECT


27 
public
:

28 
FeFÜm
(
msgid
, 
QWidg‘
 *
·»Á
 = 0);

30 
dÚe
(
»suÉ
);

31 
mªu®Subm™
();

33 
´iv©e
 
	m¦Ùs
:

34 
addFe
();

35 
d–‘eFe
();

37 
	m´iv©e
:

38 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

39 
QD©aWidg‘M­³r
 *
	mm­³r
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	mpubTimeLab–
;

42 
QLab–
 *
	mwebAddLab–
;

43 
QLab–
 *
	mkaoshiLab–
;

45 
QComboBox
 *
	mkaoshiComboBox
;

46 
QLšeEd™
 *
	mÇmeEd™
;

47 
QD©eEd™
 *
	mpubTimeEd™
;

48 
QLšeEd™
 *
	mwebAddEd™
;

50 
QPushBu‰Ú
 *
	maddBu‰Ú
;

51 
QPushBu‰Ú
 *
	md–‘eBu‰Ú
;

52 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

53 
QPushBu‰Ú
 *
	msubm™Bu‰Ú
;

54 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@KaoshiForm.h

1 #iâdeà
KAOSHIFORM_H


2 
	#KAOSHIFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

5 
	~<QSŒšg
>

7 
şass
 
	gQComboBox
;

8 
şass
 
	gQD©aWidg‘M­³r
;

9 
şass
 
	gQD©eEd™
;

10 
şass
 
	gQDŸlogBu‰ÚBox
;

11 
şass
 
	gQLab–
;

12 
şass
 
	gQLšeEd™
;

13 
şass
 
	gQPushBu‰Ú
;

14 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

17 
	mK¡y³_Pšyš
 = 0,

18 
	mK¡y³_Name
 = 1,

19 
	mK¡y³_HÙ
 = 2,

22 şas 
	cKaoshiFÜm
 : 
public
 
QDŸlog


24 
Q_OBJECT


26 
public
:

27 
KaoshiFÜm
(
QSŒšg
 
ksid
, 
QWidg‘
 *
·»Á
 = 0);

29 
dÚe
(
»suÉ
);

30 
mªu®Subm™
();

32 
´iv©e
 
	m¦Ùs
:

33 
addFe
();

34 
d–‘eFe
();

36 
	m´iv©e
:

37 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

38 
QD©aWidg‘M­³r
 *
	mm­³r
;

39 
QLab–
 *
	mpšyšLab–
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	mhÙLab–
;

45 
QLšeEd™
 *
	mpšyšEd™
;

46 
QLšeEd™
 *
	mÇmeEd™
;

47 
QLšeEd™
 *
	mhÙEd™
;

49 
QPushBu‰Ú
 *
	maddBu‰Ú
;

50 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

51 
QPushBu‰Ú
 *
	msubm™Bu‰Ú
;

52 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@
1
.
0
11
141
employeeform.cpp
employeeform.h
fileform.cpp
fileform.h
kaoshiform.cpp
kaoshiform.h
main.cpp
mainform.cpp
mainform.h
FileForm.h
KaoshiForm.h
