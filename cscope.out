cscope 16 C:\Qt\Qt5.7.1\5.7\mingw53_32\myproj\weixinhoutai               0000016858
	@employeeform.cpp

1 
	~<QtSql
>

2 
	~<QtWidg‘s
>

3 
	~"em¶oy“fÜm.h
"

5 
	gEm¶oy“FÜm
::
	$Em¶oy“FÜm
(
id
, 
QWidg‘
 *
·»Á
)

6 : 
	$QDŸlog
(
·»Á
)

8 
ÇmeEd™
 = 
Ãw
 
QLšeEd™
;

10 
ÇmeLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("Na&me:"));

11 
ÇmeLab–
->
	`£tBuddy
(
ÇmeEd™
);

13 
d•¬tm’tComboBox
 = 
Ãw
 
QComboBox
;

15 
d•¬tm’tLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("Depar&tment:"));

16 
d•¬tm’tLab–
->
	`£tBuddy
(
d•¬tm’tComboBox
);

18 
ex‹nsiÚLšeEd™
 = 
Ãw
 
QLšeEd™
;

19 
ex‹nsiÚLšeEd™
->
	`£tV®id©Ü
(
Ãw
 
	`QIÁV®id©Ü
(0, 99999, 
this
));

21 
ex‹nsiÚLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("E&xtension:"));

22 
ex‹nsiÚLab–
->
	`£tBuddy
(
ex‹nsiÚLšeEd™
);

24 
emaEd™
 = 
Ãw
 
QLšeEd™
;

26 
emaLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("&Email:"));

27 
emaLab–
->
	`£tBuddy
(
emaEd™
);

29 
¡¬tD©eEd™
 = 
Ãw
 
QD©eEd™
;

30 
¡¬tD©eEd™
->
	`£tC®’d¬Pİup
(
Œue
);

31 
QD©e
 
today
 = QD©e::
	`cu¼’tD©e
();

32 
¡¬tD©eEd™
->
	`£tD©eRªge
(
today
.
	`addDays
(-90),oday.addDays(90));

34 
¡¬tD©eLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("&Start Date:"));

35 
¡¬tD©eLab–
->
	`£tBuddy
(
¡¬tD©eEd™
);

37 
fœ¡Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("<< &First"));

38 
´eviousBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("< &Previous"));

39 
ÃxtBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Next >"));

40 
Ï¡Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Last >>"));

42 
addBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Add"));

43 
d–‘eBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Delete"));

44 
şo£Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Close"));

46 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

47 
bu‰ÚBox
->
	`addBu‰Ú
(
addBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

48 
bu‰ÚBox
->
	`addBu‰Ú
(
d–‘eBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

49 
bu‰ÚBox
->
	`addBu‰Ú
(
şo£Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

51 
bËMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

52 
bËMod–
->
	`£tTabË
("employee");

53 
bËMod–
->
	`£tR–©iÚ
(
Em¶oy“_D•¬tm’tId
,

54 
	`QSqlR–©iÚ
("department", "id", "name"));

55 
bËMod–
->
	`£tSÜt
(
Em¶oy“_Name
, 
Qt
::
AsûndšgOrd”
);

56 
bËMod–
->
	`£Ëù
();

58 
QSqlTabËMod–
 *
»ÏtiÚMod–
 =

59 
bËMod–
->
	`»ÏtiÚMod–
(
Em¶oy“_D•¬tm’tId
);

60 
d•¬tm’tComboBox
->
	`£tMod–
(
»ÏtiÚMod–
);

61 
d•¬tm’tComboBox
->
	`£tMod–CŞumn
(

62 
»ÏtiÚMod–
->
	`f›ldIndex
("name"));

64 
m­³r
 = 
Ãw
 
	`QD©aWidg‘M­³r
(
this
);

65 
m­³r
->
	`£tSubm™PŞicy
(
QD©aWidg‘M­³r
::
AutoSubm™
);

66 
m­³r
->
	`£tMod–
(
bËMod–
);

67 
m­³r
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

68 
m­³r
->
	`addM­pšg
(
ÇmeEd™
, 
Em¶oy“_Name
);

69 
m­³r
->
	`addM­pšg
(
d•¬tm’tComboBox
, 
Em¶oy“_D•¬tm’tId
);

70 
m­³r
->
	`addM­pšg
(
ex‹nsiÚLšeEd™
, 
Em¶oy“_Ex‹nsiÚ
);

71 
m­³r
->
	`addM­pšg
(
emaEd™
, 
Em¶oy“_Ema
);

72 
m­³r
->
	`addM­pšg
(
¡¬tD©eEd™
, 
Em¶oy“_S¹D©e
);

74 ià(
id
 != -1) {

75 
row
 = 0;„ow < 
bËMod–
->
	`rowCouÁ
(); ++row) {

76 
QSqlRecÜd
 
»cÜd
 = 
bËMod–
->
	`»cÜd
(
row
);

77 ià(
»cÜd
.
	`v®ue
(
Em¶oy“_Id
).
	`toIÁ
(è=ğ
id
) {

78 
m­³r
->
	`£tCu¼’tIndex
(
row
);

83 
m­³r
->
	`toFœ¡
();

86 
	`cÚÃù
(
fœ¡Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
m­³r
, 
	`SLOT
(
	`toFœ¡
()));

87 
	`cÚÃù
(
´eviousBu‰Ú
, 
	`SIGNAL
(
	`şicked
()),

88 
m­³r
, 
	`SLOT
(
	`toP»vious
()));

89 
	`cÚÃù
(
ÃxtBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
m­³r
, 
	`SLOT
(
	`toNext
()));

90 
	`cÚÃù
(
Ï¡Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
m­³r
, 
	`SLOT
(
	`toLa¡
()));

91 
	`cÚÃù
(
addBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`addEm¶oy“
()));

92 
	`cÚÃù
(
d–‘eBu‰Ú
, 
	`SIGNAL
(
	`şicked
()),

93 
this
, 
	`SLOT
(
	`d–‘eEm¶oy“
()));

94 
	`cÚÃù
(
şo£Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`acû±
()));

96 
QHBoxLayout
 *
tİBu‰ÚLayout
 = 
Ãw
 QHBoxLayout;

97 
tİBu‰ÚLayout
->
	`£tCÚ‹ÁsM¬gšs
(20, 0, 20, 5);

98 
tİBu‰ÚLayout
->
	`addSŒ‘ch
();

99 
tİBu‰ÚLayout
->
	`addWidg‘
(
fœ¡Bu‰Ú
);

100 
tİBu‰ÚLayout
->
	`addWidg‘
(
´eviousBu‰Ú
);

101 
tİBu‰ÚLayout
->
	`addWidg‘
(
ÃxtBu‰Ú
);

102 
tİBu‰ÚLayout
->
	`addWidg‘
(
Ï¡Bu‰Ú
);

103 
tİBu‰ÚLayout
->
	`addSŒ‘ch
();

105 
QGridLayout
 *
mašLayout
 = 
Ãw
 QGridLayout;

106 
mašLayout
->
	`addLayout
(
tİBu‰ÚLayout
, 0, 0, 1, 3);

107 
mašLayout
->
	`addWidg‘
(
ÇmeLab–
, 1, 0);

108 
mašLayout
->
	`addWidg‘
(
ÇmeEd™
, 1, 1, 1, 2);

109 
mašLayout
->
	`addWidg‘
(
d•¬tm’tLab–
, 2, 0);

110 
mašLayout
->
	`addWidg‘
(
d•¬tm’tComboBox
, 2, 1, 1, 2);

111 
mašLayout
->
	`addWidg‘
(
ex‹nsiÚLab–
, 3, 0);

112 
mašLayout
->
	`addWidg‘
(
ex‹nsiÚLšeEd™
, 3, 1);

113 
mašLayout
->
	`addWidg‘
(
emaLab–
, 4, 0);

114 
mašLayout
->
	`addWidg‘
(
emaEd™
, 4, 1, 1, 2);

115 
mašLayout
->
	`addWidg‘
(
¡¬tD©eLab–
, 5, 0);

116 
mašLayout
->
	`addWidg‘
(
¡¬tD©eEd™
, 5, 1);

117 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
, 7, 0, 1, 3);

118 
mašLayout
->
	`£tRowMšimumHeight
(6, 10);

119 
mašLayout
->
	`£tRowSŒ‘ch
(6, 1);

120 
mašLayout
->
	`£tCŞumnSŒ‘ch
(2, 1);

121 
	`£tLayout
(
mašLayout
);

123 ià(
id
 == -1) {

124 
ÃxtBu‰Ú
->
	`£tFocus
();

126 
ÇmeEd™
->
	`£tFocus
();

129 
	`£tWšdowT™Ë
(
	`Œ
("Edit Employees"));

130 
	}
}

132 
	gEm¶oy“FÜm
::
	$dÚe
(
»suÉ
)

134 
m­³r
->
	`subm™
();

135 
QDŸlog
::
	`dÚe
(
»suÉ
);

136 
	}
}

138 
	gEm¶oy“FÜm
::
	$addEm¶oy“
()

140 
row
 = 
m­³r
->
	`cu¼’tIndex
();

141 
m­³r
->
	`subm™
();

142 
bËMod–
->
	`š£¹Row
(
row
);

143 
m­³r
->
	`£tCu¼’tIndex
(
row
);

145 
ÇmeEd™
->
	`ş—r
();

146 
ex‹nsiÚLšeEd™
->
	`ş—r
();

147 
¡¬tD©eEd™
->
	`£tD©e
(
QD©e
::
	`cu¼’tD©e
());

148 
ÇmeEd™
->
	`£tFocus
();

149 
	}
}

151 
	gEm¶oy“FÜm
::
	$d–‘eEm¶oy“
()

153 
row
 = 
m­³r
->
	`cu¼’tIndex
();

154 
bËMod–
->
	`»moveRow
(
row
);

155 
m­³r
->
	`subm™
();

156 
m­³r
->
	`£tCu¼’tIndex
(
	`qMš
(
row
, 
bËMod–
->
	`rowCouÁ
() - 1));

157 
	}
}

	@employeeform.h

1 #iâdeà
EMPLOYEEFORM_H


2 
	#EMPLOYEEFORM_H


	)

3 
	~<QtWidg‘s
>

4 
	~<QDŸlog
>

6 
şass
 
	gQComboBox
;

7 
şass
 
	gQD©aWidg‘M­³r
;

8 
şass
 
	gQD©eEd™
;

9 
şass
 
	gQDŸlogBu‰ÚBox
;

10 
şass
 
	gQLab–
;

11 
şass
 
	gQLšeEd™
;

12 
şass
 
	gQPushBu‰Ú
;

13 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

16 
	mEm¶oy“_Id
 = 0,

17 
	mEm¶oy“_Name
 = 1,

18 
	mEm¶oy“_D•¬tm’tId
 = 2,

19 
	mEm¶oy“_Ex‹nsiÚ
 = 3,

20 
	mEm¶oy“_Ema
 = 4,

21 
	mEm¶oy“_S¹D©e
 = 5

24 şas 
	cEm¶oy“FÜm
 : 
public
 
QDŸlog


26 
Q_OBJECT


28 
public
:

29 
Em¶oy“FÜm
(
id
, 
QWidg‘
 *
·»Á
 = 0);

31 
dÚe
(
»suÉ
);

33 
´iv©e
 
	m¦Ùs
:

34 
addEm¶oy“
();

35 
d–‘eEm¶oy“
();

37 
	m´iv©e
:

38 
QSqlR–©iÚ®TabËMod–
 *
bËMod–
;

39 
QD©aWidg‘M­³r
 *
	mm­³r
;

40 
QLab–
 *
	mÇmeLab–
;

41 
QLab–
 *
	md•¬tm’tLab–
;

42 
QLab–
 *
	mex‹nsiÚLab–
;

43 
QLab–
 *
	memaLab–
;

44 
QLab–
 *
	m¡¬tD©eLab–
;

45 
QLšeEd™
 *
	mÇmeEd™
;

46 
QComboBox
 *
	md•¬tm’tComboBox
;

47 
QLšeEd™
 *
	mex‹nsiÚLšeEd™
;

48 
QLšeEd™
 *
	memaEd™
;

49 
QD©eEd™
 *
	m¡¬tD©eEd™
;

50 
QPushBu‰Ú
 *
	mfœ¡Bu‰Ú
;

51 
QPushBu‰Ú
 *
	m´eviousBu‰Ú
;

52 
QPushBu‰Ú
 *
	mÃxtBu‰Ú
;

53 
QPushBu‰Ú
 *
	mÏ¡Bu‰Ú
;

54 
QPushBu‰Ú
 *
	maddBu‰Ú
;

55 
QPushBu‰Ú
 *
	md–‘eBu‰Ú
;

56 
QPushBu‰Ú
 *
	mşo£Bu‰Ú
;

57 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@main.cpp

1 
	~<QtGui
>

2 
	~<QtSql
>

3 
	~<c¡dlib
>

4 
	~<QtWidg‘s
>

6 
	~"mašfÜm.h
"

8 
boŞ
 
	$ü—‹CÚÃùiÚ
()

10 
QSqlD©aba£
 
db
 = QSqlD©aba£::
	`addD©aba£
("QMYSQL");

12 
db
.
	`£tHo¡Name
("58.87.119.233");

13 
db
.
	`£tD©aba£Name
("bjks2");

14 
db
.
	`£tU£rName
("root");

15 
db
.
	`£tPasswÜd
("123123");

16 ià(!
db
.
	`İ’
()) {

17 
QMes§geBox
::
	`w¬nšg
(0, 
QObjeù
::
	`Œ
("Database Error"),

18 
db
.
	`Ï¡E¼Ü
().
	`‹xt
());

19  
çl£
;

21  
Œue
;

22 
	}
}

24 
	$maš
(
¬gc
, *
¬gv
[])

26 
QAµliÿtiÚ
 
	`­p
(
¬gc
, 
¬gv
);

27 
	`ü—‹CÚÃùiÚ
();

28 
MašFÜm
 
fÜm
;

29 
fÜm
.
	`»size
(500, 600);

30 
fÜm
.
	`show
();

31  
­p
.
	`exec
();

32 
	}
}

	@mainform.cpp

1 
	~<QtGui
>

2 
	~<QtSql
>

3 
	~<SŒšg
>

4 
	~"em¶oy“fÜm.h
"

5 
	~"mašfÜm.h
"

7 
	gMašFÜm
::
	$MašFÜm
()

9 
	`ü—‹D•¬tm’tPª–
();

10 
	`ü—‹Em¶oy“Pª–
();

11 
	`ü—‹KaoshiPª–
();

13 
¥l™‹r
 = 
Ãw
 
	`QS¶™‹r
(
Qt
::
V”tiÿl
);

14 
¥l™‹r
->
	`£tF¿meStyË
(
QF¿me
::
StyËdPª–
);

15 
¥l™‹r
->
	`addWidg‘
(
d•¬tm’tPª–
);

16 
¥l™‹r
->
	`addWidg‘
(
em¶oy“Pª–
);

21 
addBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Add Dept."));

22 
d–‘eBu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Delete Dept."));

23 
ed™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Edit Employees..."));

24 
qu™Bu‰Ú
 = 
Ãw
 
	`QPushBu‰Ú
(
	`Œ
("&Quit"));

26 
bu‰ÚBox
 = 
Ãw
 
QDŸlogBu‰ÚBox
;

27 
bu‰ÚBox
->
	`addBu‰Ú
(
addBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

28 
bu‰ÚBox
->
	`addBu‰Ú
(
d–‘eBu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

29 
bu‰ÚBox
->
	`addBu‰Ú
(
ed™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
AùiÚRŞe
);

30 
bu‰ÚBox
->
	`addBu‰Ú
(
qu™Bu‰Ú
, 
QDŸlogBu‰ÚBox
::
Acû±RŞe
);

32 
	`cÚÃù
(
addBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`addD•¬tm’t
()));

33 
	`cÚÃù
(
d–‘eBu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`d–‘eD•¬tm’t
()));

34 
	`cÚÃù
(
ed™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`ed™Em¶oy“s
()));

35 
	`cÚÃù
(
qu™Bu‰Ú
, 
	`SIGNAL
(
	`şicked
()), 
this
, 
	`SLOT
(
	`şo£
()));

37 
QVBoxLayout
 *
mašLayout
 = 
Ãw
 QVBoxLayout;

38 
mašLayout
->
	`addWidg‘
(
kaoshiPª–
);

39 
mašLayout
->
	`addWidg‘
(
¥l™‹r
);

40 
mašLayout
->
	`addWidg‘
(
bu‰ÚBox
);

42 
	`£tLayout
(
mašLayout
);

44 
	`£tWšdowT™Ë
(
	`Œ
("Staff Manager"));

46 
d•¬tm’tV›w
->
	`£tCu¼’tIndex
(
d•¬tm’tMod–
->
	`šdex
(0, 0));

47 
	}
}

49 
	gMašFÜm
::
	$upd©eMsgV›w
()

51 
QMod–Index
 
šdex
 = 
d•¬tm’tV›w
->
	`cu¼’tIndex
();

52 ià(
šdex
.
	`isV®id
()) {

53 
QSqlRecÜd
 
»cÜd
 = 
d•¬tm’tMod–
->
	`»cÜd
(
šdex
.
	`row
());

54 
id
 = 
»cÜd
.
	`v®ue
("ksfeid").
	`toIÁ
();

55 
em¶oy“Mod–
->
	`£tF‹r
(
	`QSŒšg
("ksmsg.ksfeid = %1").
	`¬g
(
id
));

56 
em¶oy“Lab–
->
	`£tText
(
	`Œ
("é…ç½® %1 è€ƒè¯•çš„æ¶ˆæ¯msg")

57 .
	`¬g
(
»cÜd
.
	`v®ue
("ksid").
	`toSŒšg
()));

60 
em¶oy“Mod–
->
	`£tF‹r
("ksfileid = -1");

61 
em¶oy“Lab–
->
	`£tText
(
	`Œ
("E&mployees"));

63 
em¶oy“Mod–
->
	`£Ëù
();

64 
em¶oy“V›w
->
	`hÜizÚlH—d”
()->
	`£tVisibË
(

65 
em¶oy“Mod–
->
	`rowCouÁ
() > 0);

68 
	}
}

70 
	gMašFÜm
::
	$addD•¬tm’t
()

72 
row
 = 
d•¬tm’tMod–
->
	`rowCouÁ
();

73 
d•¬tm’tMod–
->
	`š£¹Row
(
row
);

74 
QMod–Index
 
šdex
 = 
d•¬tm’tMod–
->
	`šdex
(
row
, 
D•¬tm’t_Name
);

75 
d•¬tm’tV›w
->
	`£tCu¼’tIndex
(
šdex
);

76 
d•¬tm’tV›w
->
	`ed™
(
šdex
);

77 
	}
}

79 
	gMašFÜm
::
	$d–‘eD•¬tm’t
()

81 
QMod–Index
 
šdex
 = 
d•¬tm’tV›w
->
	`cu¼’tIndex
();

82 ià(!
šdex
.
	`isV®id
())

85 
QSqlD©aba£
::
	`d©aba£
().
	`Œª§ùiÚ
();

86 
QSqlRecÜd
 
»cÜd
 = 
d•¬tm’tMod–
->
	`»cÜd
(
šdex
.
	`row
());

87 
id
 = 
»cÜd
.
	`v®ue
(
D•¬tm’t_Id
).
	`toIÁ
();

88 
numEm¶oy“s
 = 0;

90 
QSqlQu”y
 
	`qu”y
(
	`QSŒšg
("SELECT COUNT(*) FROMƒmployee "

91 "WHERE d•¬tm’tid = %1").
	`¬g
(
id
));

92 ià(
qu”y
.
	`Ãxt
())

93 
numEm¶oy“s
 = 
qu”y
.
	`v®ue
(0).
	`toIÁ
();

94 ià(
numEm¶oy“s
 > 0) {

95 
r
 = 
QMes§geBox
::
	`w¬nšg
(
this
, 
	`Œ
("Delete Department"),

96 
	`Œ
("Delete %1‡nd‡ll itsƒmployees?")

97 .
	`¬g
(
»cÜd
.
	`v®ue
(
D•¬tm’t_Name
).
	`toSŒšg
()),

98 
QMes§geBox
::
Yes
 | QMes§geBox::
No
);

99 ià(
r
 =ğ
QMes§geBox
::
No
) {

100 
QSqlD©aba£
::
	`d©aba£
().
	`rŞlback
();

104 
qu”y
.
	`exec
(
	`QSŒšg
("DELETE FROMƒmployee "

105 "WHERE d•¬tm’tid = %1").
	`¬g
(
id
));

108 
d•¬tm’tMod–
->
	`»moveRow
(
šdex
.
	`row
());

109 
d•¬tm’tMod–
->
	`subm™AÎ
();

110 
QSqlD©aba£
::
	`d©aba£
().
	`comm™
();

112 
	`upd©eMsgV›w
();

113 
d•¬tm’tV›w
->
	`£tFocus
();

114 
	}
}

116 
	gMašFÜm
::
	$ed™Em¶oy“s
()

118 
em¶oy“Id
 = -1;

119 
QMod–Index
 
šdex
 = 
em¶oy“V›w
->
	`cu¼’tIndex
();

120 ià(
šdex
.
	`isV®id
()) {

121 
QSqlRecÜd
 
»cÜd
 = 
em¶oy“Mod–
->
	`»cÜd
(
šdex
.
	`row
());

122 
em¶oy“Id
 = 
»cÜd
.
	`v®ue
(
Em¶oy“_Id
).
	`toIÁ
();

125 
Em¶oy“FÜm
 
	`fÜm
(
em¶oy“Id
, 
this
);

126 
fÜm
.
	`exec
();

127 
	`upd©eMsgV›w
();

128 
	}
}

130 
	gMašFÜm
::
	$ü—‹D•¬tm’tPª–
()

132 
d•¬tm’tPª–
 = 
Ãw
 
QWidg‘
;

134 
d•¬tm’tMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

135 
d•¬tm’tMod–
->
	`£tTabË
("ksfile");

138 
d•¬tm’tMod–
->
	`£tSÜt
(
D•¬tm’t_Name
, 
Qt
::
AsûndšgOrd”
);

143 
d•¬tm’tMod–
->
	`£Ëù
();

145 
d•¬tm’tV›w
 = 
Ãw
 
QTabËV›w
;

146 
d•¬tm’tV›w
->
	`£tMod–
(
d•¬tm’tMod–
);

147 
d•¬tm’tV›w
->
	`£tI‹mD–eg©e
(
Ãw
 
	`QSqlR–©iÚ®D–eg©e
(
this
));

148 
d•¬tm’tV›w
->
	`£tS–eùiÚMode
(

149 
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

150 
d•¬tm’tV›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

152 
d•¬tm’tV›w
->
	`»sizeCŞumnsToCÚ‹Ás
();

153 
d•¬tm’tV›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

154 
d•¬tm’tV›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

156 
d•¬tm’tLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("Depar&tments"));

157 
d•¬tm’tLab–
->
	`£tBuddy
(
d•¬tm’tV›w
);

159 
	`cÚÃù
(
d•¬tm’tV›w
->
	`£ËùiÚMod–
(),

160 
	`SIGNAL
(
	`cu¼’tRowChªged
(cÚ¡ 
QMod–Index
 &,

161 cÚ¡ 
QMod–Index
 &)),

162 
this
, 
	`SLOT
(
	`upd©eMsgV›w
()));

164 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

165 
Ïyout
->
	`addWidg‘
(
d•¬tm’tLab–
);

166 
Ïyout
->
	`addWidg‘
(
d•¬tm’tV›w
);

167 
d•¬tm’tPª–
->
	`£tLayout
(
Ïyout
);

168 
	}
}

170 
	gMašFÜm
::
	$ü—‹Em¶oy“Pª–
()

172 
em¶oy“Pª–
 = 
Ãw
 
QWidg‘
;

173 
em¶oy“Mod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

174 
em¶oy“Mod–
->
	`£tTabË
("ksmsg");

175 
em¶oy“Mod–
->
	`£tR–©iÚ
(3,

176 
	`QSqlR–©iÚ
("ksfile","ksfileid","ksid"));

185 
em¶oy“V›w
 = 
Ãw
 
QTabËV›w
;

186 
em¶oy“V›w
->
	`£tMod–
(
em¶oy“Mod–
);

187 
em¶oy“V›w
->
	`£tS–eùiÚMode
(
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

188 
em¶oy“V›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

189 
em¶oy“V›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

190 
em¶oy“V›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

191 
em¶oy“V›w
->
	`£tCŞumnHidd’
(0, 
Œue
);

192 
em¶oy“V›w
->
	`£tCŞumnHidd’
(3, 
Œue
);

193 
em¶oy“V›w
->
	`£tCŞumnHidd’
(4, 
Œue
);

195 
em¶oy“Lab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("E&mployees"));

196 
em¶oy“Lab–
->
	`£tBuddy
(
em¶oy“V›w
);

198 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

199 
Ïyout
->
	`addWidg‘
(
em¶oy“Lab–
);

200 
Ïyout
->
	`addWidg‘
(
em¶oy“V›w
);

201 
em¶oy“Pª–
->
	`£tLayout
(
Ïyout
);

202 
	}
}

204 
	gMašFÜm
::
	$ü—‹KaoshiPª–
()

206 
kaoshiPª–
 = 
Ãw
 
QWidg‘
;

207 
kaoshiMod–
 = 
Ãw
 
	`QSqlR–©iÚ®TabËMod–
(
this
);

208 
kaoshiMod–
->
	`£tTabË
("kstype");

209 
kaoshiMod–
->
	`£Ëù
();

210 
kaoshiV›w
 = 
Ãw
 
QTabËV›w
;

211 
kaoshiV›w
->
	`£tMod–
(
kaoshiMod–
);

212 
kaoshiV›w
->
	`£tS–eùiÚMode
(
QAb¡¿ùI‹mV›w
::
SšgËS–eùiÚ
);

213 
kaoshiV›w
->
	`£tS–eùiÚBehaviÜ
(
QAb¡¿ùI‹mV›w
::
S–eùRows
);

214 
kaoshiV›w
->
	`£tEd™Trigg”s
(
QAb¡¿ùI‹mV›w
::
NoEd™Trigg”s
);

215 
kaoshiV›w
->
	`hÜizÚlH—d”
()->
	`£tSŒ‘chLa¡SeùiÚ
(
Œue
);

217 
kaoshiLab–
 = 
Ãw
 
	`QLab–
(
	`Œ
("E&mployees"));

218 
kaoshiLab–
->
	`£tBuddy
(
kaoshiV›w
);

220 
	`cÚÃù
(
kaoshiV›w
->
	`£ËùiÚMod–
(),

221 
	`SIGNAL
(
	`cu¼’tRowChªged
(cÚ¡ 
QMod–Index
 &,

222 cÚ¡ 
QMod–Index
 &)),

223 
this
, 
	`SLOT
(
	`upd©eFeV›w
()));

224 
QVBoxLayout
 *
Ïyout
 = 
Ãw
 QVBoxLayout;

225 
Ïyout
->
	`addWidg‘
(
kaoshiLab–
);

226 
Ïyout
->
	`addWidg‘
(
kaoshiV›w
);

227 
kaoshiPª–
->
	`£tLayout
(
Ïyout
);

228 
	}
}

230 
	gMašFÜm
::
	$upd©eFeV›w
()

232 
QMod–Index
 
šdex
 = 
kaoshiV›w
->
	`cu¼’tIndex
();

233 ià(
šdex
.
	`isV®id
()) {

234 
QSqlRecÜd
 
»cÜd
 = 
kaoshiMod–
->
	`»cÜd
(
šdex
.
	`row
());

235 
QSŒšg
 
id
 = 
»cÜd
.
	`v®ue
("ksid").
	`toSŒšg
();

236 
d•¬tm’tMod–
->
	`£tF‹r
(
	`QSŒšg
("ksfe.ksid = \"%1\" ").
	`¬g
(
id
));

238 
d•¬tm’tLab–
->
	`£tText
(
	`Œ
(" %1 æ–‡ä»¶ç®¡ç†")

239 .
	`¬g
(
»cÜd
.
	`v®ue
("k¢ame").
	`toSŒšg
()));

242 
d•¬tm’tMod–
->
	`£tF‹r
("ksid = -1");

243 
d•¬tm’tLab–
->
	`£tText
(
	`Œ
("è€ƒè¯•æ–‡ä»¶"));

245 
d•¬tm’tMod–
->
	`£Ëù
();

246 
d•¬tm’tV›w
->
	`hÜizÚlH—d”
()->
	`£tVisibË
(

247 
d•¬tm’tMod–
->
	`rowCouÁ
() > 0);

250 
	}
}

	@mainform.h

1 #iâdeà
MAINFORM_H


2 
	#MAINFORM_H


	)

4 
	~<QWidg‘
>

6 
şass
 
	gQDŸlogBu‰ÚBox
;

7 
şass
 
	gQLab–
;

8 
şass
 
	gQMod–Index
;

9 
şass
 
	gQPushBu‰Ú
;

10 
şass
 
	gQS¶™‹r
;

11 
şass
 
	gQSqlR–©iÚ®TabËMod–
;

12 
şass
 
	gQTabËV›w
;

15 
	mD•¬tm’t_Id
 = 0,

16 
	mD•¬tm’t_Name
 = 1,

17 
	mD•¬tm’t_LoÿtiÚId
 = 2,

18 
	mf•ubtime
 = 3,

19 
	mwebadd»ss
 = 4,

22 şas 
	cMašFÜm
 : 
public
 
QWidg‘


24 
Q_OBJECT


26 
public
:

27 
MašFÜm
();

29 
´iv©e
 
	m¦Ùs
:

30 
upd©eMsgV›w
();

31 
upd©eFeV›w
();

32 
addD•¬tm’t
();

33 
d–‘eD•¬tm’t
();

34 
ed™Em¶oy“s
();

36 
	m´iv©e
:

37 
ü—‹D•¬tm’tPª–
();

38 
ü—‹Em¶oy“Pª–
();

39 
ü—‹KaoshiPª–
();

41 
QSqlR–©iÚ®TabËMod–
 *
	md•¬tm’tMod–
;

42 
QSqlR–©iÚ®TabËMod–
 *
	mem¶oy“Mod–
;

43 
QSqlR–©iÚ®TabËMod–
 *
	mkaoshiMod–
;

45 
QWidg‘
 *
	md•¬tm’tPª–
;

46 
QWidg‘
 *
	mem¶oy“Pª–
;

47 
QWidg‘
 *
	mkaoshiPª–
;

48 
QLab–
 *
	md•¬tm’tLab–
;

49 
QLab–
 *
	mem¶oy“Lab–
;

50 
QLab–
 *
	mkaoshiLab–
;

52 
QTabËV›w
 *
	md•¬tm’tV›w
;

53 
QTabËV›w
 *
	mem¶oy“V›w
;

54 
QTabËV›w
 *
	mkaoshiV›w
;

56 
QS¶™‹r
 *
	m¥l™‹r
;

57 
QS¶™‹r
 *
	mkaoshi¥l™‹r
;

59 
QPushBu‰Ú
 *
	maddBu‰Ú
;

60 
QPushBu‰Ú
 *
	md–‘eBu‰Ú
;

61 
QPushBu‰Ú
 *
	med™Bu‰Ú
;

62 
QPushBu‰Ú
 *
	mqu™Bu‰Ú
;

63 
QDŸlogBu‰ÚBox
 *
	mbu‰ÚBox
;

	@
1
.
0
5
65
employeeform.cpp
employeeform.h
main.cpp
mainform.cpp
mainform.h
